# AWSで作るマイクロサービス
NTTデータ 川畑光平

AWS 社内推進

https://debugroom.github.io/spring-fest/2020_12/aws_spring_msa.html

複雑性とのトレードオフ
- サービス認証/認可方式
- ロギング/モニタリング方式
- BackendService

AWS + Springで構築するポイントを紹介


AWS X-Rayを使った分散トレーシング


## X-Rayへのメトリクスデータを送信

X Ray daemon
をサイドカー起動
App SDKから送信する
X Ray daemon -> X-Ray APIへ送信

X Ray daemon -> X-Ray APIへ送信


## 認証・認可
OIDC/OAUTH2

SpringSecurity OAuth2 Login
によりCognitoユーザープール内のユーザーで認証し、アクセストークンおよびIDトークンを取得する

なぜOAuth2を使用した認可でマイクロサービスを保護するのか？

 - サードパーティ含めてクライアントが増えた場合、マイクロサービス側が通常の認証処理だとユーザー管理・確認が煩雑になる。
   シンプルかのためにサードパーティ側の認証・認可の仕組みで発行したアクセストークンを使って、マイクロサービスのアクセスを制御する。

 - JWT形式によるアクセストークンエンコーディングにより、クライアントが増えた場合のスケーラビリティの確保が用意である

 - デファクトスタンダードな認可技術の採用により、様々なプロダクトと連携させたり、セキュリティを担保








